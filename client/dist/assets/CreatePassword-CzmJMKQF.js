import{k as y,u as b,e as v,c as k,d as m,b as l,w as C,q as D,r as i,o as L}from"./index-D13uKbqF.js";var p={exports:{}};const g=[{id:0,value:"Too weak",minDiversity:0,minLength:0},{id:1,value:"Weak",minDiversity:2,minLength:6},{id:2,value:"Medium",minDiversity:4,minLength:8},{id:3,value:"Strong",minDiversity:4,minLength:10}],f=(c,o=g,a="!\"#$%&'()*+,-./:;<=>?@[\\\\\\]^_`{|}~")=>{let t=c||"";o[0].minDiversity=0,o[0].minLength=0;const r=[{regex:"[a-z]",message:"lowercase"},{regex:"[A-Z]",message:"uppercase"},{regex:"[0-9]",message:"number"}];a&&r.push({regex:`[${a}]`,message:"symbol"});let n={};n.contains=r.filter(e=>new RegExp(`${e.regex}`).test(t)).map(e=>e.message),n.length=t.length;let u=o.filter(e=>n.contains.length>=e.minDiversity).filter(e=>n.length>=e.minLength).sort((e,s)=>s.id-e.id).map(e=>({id:e.id,value:e.value}));return Object.assign(n,u[0]),n};p.exports={passwordStrength:f,defaultOptions:g};var S=p.exports.passwordStrength=f;p.exports.defaultOptions=g;const $={class:"grid content-center h-full w-full"},V=m("h2",{class:"my-2 text-center"},"You'll need a password",-1),B={__name:"CreatePassword",setup(c){const o=y(),a=b(),t=v(""),r=v("");async function n(){r.value=S(t.value).value}async function u(){let e=await a.createPassword(a.app.user.uid,t.value);await a.login({id:a.$state.app.user.email,password:t.value}),e?o.push("/auth/pick-profile-picture"):console.log(e)}return(e,s)=>{const w=i("v-img"),x=i("v-text-field"),h=i("v-btn"),_=i("v-form");return L(),k("div",$,[m("div",null,[l(w,{src:"../assets/img/logo.png",class:"w-20 h-20 mx-auto my-8 rounded-sm"})]),m("div",null,[V,l(_,{onSubmit:s[3]||(s[3]=D(()=>{},["prevent"])),class:"flex flex-col mx-4 gap-4"},{default:C(()=>[l(x,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=d=>t.value=d),label:"Create Password",id:"password",type:"password",onInput:s[1]||(s[1]=d=>n()),messages:r.value},null,8,["modelValue","messages"]),l(h,{loading:e.loading,class:"mt-2",text:"Next",block:"",onClick:s[2]||(s[2]=d=>u())},null,8,["loading"])]),_:1})])])}}};export{B as default};
